<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="TRAFFIK_APP.Views.StaffBookingDetailPage"
             BackgroundColor="#0A0E27"
             Shell.FlyoutBehavior="Disabled">

    <Grid RowDefinitions="Auto,*">
        <!-- Top Bar -->
        <Grid Padding="24,16" Row="0" BackgroundColor="#161B33">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Button Grid.Column="0"
                    Text="â† Back"
                    Command="{Binding GoBackCommand}"
                    BackgroundColor="Transparent"
                    TextColor="#9CA3AF"
                    FontSize="16" />
            <Label Grid.Column="1"
                   Text="Booking Details"
                   FontSize="20"
                   FontAttributes="Bold"
                   TextColor="White"
                   HorizontalOptions="Center" />
        </Grid>

        <!-- Main Content -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Padding="20" Spacing="20">
                
                <!-- Booking Info Card -->
                <Border BackgroundColor="#1E293B"
                        StrokeThickness="1"
                        Stroke="#334155"
                        Padding="0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12"/>
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="#000000" 
                                Offset="0,4" 
                                Radius="8" 
                                Opacity="0.3"/>
                    </Border.Shadow>
                    <Grid Padding="16" RowDefinitions="Auto,Auto,Auto,Auto" RowSpacing="12">
                        <Label Text="Booking Information"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="White"
                               Grid.Row="0" />
                        
                        <Grid Grid.Row="1" ColumnDefinitions="Auto,*" ColumnSpacing="12">
                            <Label Text="Booking ID:"
                                   TextColor="#9CA3AF"
                                   FontSize="14" />
                            <Label Text="{Binding CurrentBooking.BookingId, StringFormat='#{0}'}"
                                   TextColor="White"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   Grid.Column="1" />
                        </Grid>

                        <Grid Grid.Row="2" ColumnDefinitions="Auto,*" ColumnSpacing="12">
                            <Label Text="Customer:"
                                   TextColor="#9CA3AF"
                                   FontSize="14" />
                            <Label Text="{Binding UserName}"
                                   TextColor="White"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   Grid.Column="1" />
                        </Grid>

                        <Grid Grid.Row="3" ColumnDefinitions="Auto,*" ColumnSpacing="12">
                            <Label Text="Service:"
                                   TextColor="#9CA3AF"
                                   FontSize="14" />
                            <Label Text="{Binding ServiceName}"
                                   TextColor="White"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   Grid.Column="1" />
                        </Grid>

                        <Grid Grid.Row="4" ColumnDefinitions="Auto,*" ColumnSpacing="12">
                            <Label Text="Vehicle:"
                                   TextColor="#9CA3AF"
                                   FontSize="14" />
                            <Label Text="{Binding CurrentBooking.VehicleId, StringFormat='Vehicle #{0}'}"
                                   TextColor="White"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   Grid.Column="1" />
                        </Grid>

                        <Grid Grid.Row="5" ColumnDefinitions="Auto,*" ColumnSpacing="12">
                            <Label Text="Current Status:"
                                   TextColor="#9CA3AF"
                                   FontSize="14" />
                            <Border Grid.Column="1"
                                    BackgroundColor="#2563EB"
                                    Padding="10,5"
                                    HorizontalOptions="Start">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="6"/>
                                </Border.StrokeShape>
                                <Label Text="{Binding CurrentBooking.CurrentStage}"
                                       TextColor="White" />
                            </Border>
                        </Grid>
                    </Grid>
                </Border>

                <!-- Update Status Card -->
                <Border BackgroundColor="#1E293B"
                        StrokeThickness="1"
                        Stroke="#334155"
                        Padding="0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12"/>
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="#000000" 
                                Offset="0,4" 
                                Radius="8" 
                                Opacity="0.3"/>
                    </Border.Shadow>
                    <Grid Padding="16" RowDefinitions="Auto,Auto,Auto" RowSpacing="16">
                        <Label Text="Update Status"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="White"
                               Grid.Row="0" />

                        <Label Text="Select the new status for this booking:"
                               FontSize="13"
                               TextColor="#9CA3AF"
                               Margin="0,-10,0,0"
                               Grid.Row="1" />

                        <VerticalStackLayout Grid.Row="2" Spacing="12">
                            <Picker ItemsSource="{Binding CurrentBooking.AvailableStages}"
                                    SelectedItem="{Binding CurrentBooking.SelectedStage}"
                                    TextColor="White"
                                    TitleColor="White"
                                    BackgroundColor="#0F172A"
                                    FontSize="14" />
                            
                            <Button Text="Update Status"
                                    Command="{Binding UpdateStageCommand}"
                                    BackgroundColor="#10B981"
                                    TextColor="White"
                                    CornerRadius="8"
                                    Padding="0,15"
                                    FontAttributes="Bold"
                                    FontSize="16" />
                        </VerticalStackLayout>
                    </Grid>
                </Border>

            </VerticalStackLayout>
        </ScrollView>
    </Grid>

</ContentPage>

